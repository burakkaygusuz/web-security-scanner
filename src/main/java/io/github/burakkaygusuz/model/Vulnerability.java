package io.github.burakkaygusuz.model;

public record Vulnerability(VulnerabilityType type, String url, String parameter, String payload) {

  // Removed severity constants, use Severity class instead.

  // Backward compatibility constructor that accepts String type
  public Vulnerability(String type, String url, String parameter, String payload) {
    this(VulnerabilityType.fromDisplayName(type), url, parameter, payload);
  }

  public String getSeverity() {
    return type.getSeverity();
  }

  public int getSeverityScore() {
    return type.getSeverityScore();
  }

  /**
   * Gets the vulnerability type display name for backward compatibility.
   *
   * @return the display name of the vulnerability type
   */
  public String getTypeName() {
    return type.getDisplayName();
  }

  /**
   * Gets the vulnerability type description.
   *
   * @return the description of the vulnerability type
   */
  public String getTypeDescription() {
    return type.getDescription();
  }
}
