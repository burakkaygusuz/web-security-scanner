package io.github.burakkaygusuz;

public record Vulnerability(String type, String url, String parameter, String payload) {

  public static final String LOW = "LOW";
  public static final String MEDIUM = "MEDIUM";
  public static final String HIGH = "HIGH";
  public static final String CRITICAL = "CRITICAL";

  public static final String[] SEVERITIES = {LOW, MEDIUM, HIGH, CRITICAL};

  public String getSeverity() {
    return switch (type) {
      case "SQL Injection" -> CRITICAL;
      case "Cross-Site Scripting (XSS)" -> HIGH;
      case "Sensitive Information Exposure" -> MEDIUM;
      default -> LOW;
    };
  }

  public int getSeverityScore() {
    return switch (getSeverity()) {
      case CRITICAL -> 4;
      case HIGH -> 3;
      case MEDIUM -> 2;
      case LOW -> 1;
      default -> 0;
    };
  }
}
